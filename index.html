<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"> 
  <title>Tasbih Reward</title>
  <style>
    /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é –∏ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ */
    .menu-btn {
      position: fixed;
      top: 10px;
      left: 20px;
      font-size: 30px;
      cursor: pointer;
      z-index: 1001;
      color: white;
      text-shadow: 0 0 3px rgba(0,0,0,0.5);
    }

    .sidebar {
      position: fixed;
      left: -60%;
      top: 10px;
      width: 90%;
      height: 90%;
      background: rgba(10, 30, 40, .99);
      box-shadow: 1px 0 8px rgba(255,255,255,0.99);
      transition: 0.3s;
      z-index: 1002;
      color: white;
      display: flex;
      flex-direction: column;
    }
    .sidebar.active {
      left: 0;
    }

#user-container {
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #007bff, #6610f2);
    color: white;
    padding: 10px 15px;
    border-radius: 10px;
    font-size: 18px;
    font-weight: bold;
    margin: 10px auto;
    width: 80%;
    text-align: center;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

    /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–ø–∏—Å–∫–∞ –º–µ–Ω—é –∏ —Ä—è–¥–∞ –∫–Ω–æ–ø–æ–∫ */
    .menu-items {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .menu-items li a {
      display: block;
      padding: 10px 20px;
      text-decoration: none;
      color: #fff;
      font-size: 16px;
    }

    .menu-buttons-row {
      display: flex;
      justify-content: space-around;
      margin: 10px 0;
    }

    .menu-buttons-row button {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #fff;
    }

    /* –ë–ª–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
    .stats-container {
      padding: 1px 10px;
      border-top: 1px solid #102351;
      background: rgba(0,0,0,0.2);
    }

    .stat-item {
      margin: 10px 0;
    }

    .stat-progress {
      height: 8px;
      background: rgba(255,255,255,0.1);
      border-radius: 4px;
      margin: 5px 0;
      overflow: hidden;
    }

    .stat-progress-bar {
      height: 100%;
      background: #4CAF50;
      width: 0%;
      transition: width 0.3s ease;
    }

    .stat-label {
      font-size: 13px;
      color: #aaa;
      margin-bottom: 3px;
    }

    .stat-value {
      font-size: 15px;
      font-weight: bold;
    }

    /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–ª–∞ */
    body {
      font-family: 'Arial', sans-serif;
      background-image: url('2.jpg');
      background-size: cover;
      background-position: center;
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: #fff;
    }

    .top-link {
      position: fixed;
      top: 15px;
      right: 50px;
      color: #9900cc;
      text-decoration: none;
      font-size: 13px;
      background: rgba(0,0,0,0.2);
      padding: 8px 8px;
      border-radius: 10px;
      font-weight: bold;
      z-index: 1000;
    }
    .top-link:hover {
      background: rgba(0,0,0,0.5);
    }

    .level-container {
      width: 40%;
      margin-bottom: 15px;
      margin-left: 20px;
      margin-right: auto;
    }

    .level-bar {
      height: 20px;
      background: rgba(255,255,255,0.1);
      border-radius: 9px;
      position: relative;
      overflow: hidden;
    }

    .level-progress {
      height: 100%;
      background: #66ffCC;
      width: 0%;
      transition: width 0.3s ease;
    }

    .level-text {
      position: absolute;
      top: 40%;
      left: 40%;
      transform: translate(-40%, -40%);
      font-weight: bold;
      color: #aaa;
      font-size: 13px;
    }

    .main-progress-container {
      width: 90%;
      margin-bottom: 250px;
      transition: margin 0.3s;
    }

    .main-progress-bar {
      height: 60px;
      background: rgba(255,255,255,0.1);
      border-radius: 15px;
      position: relative;
      overflow: hidden;
    }

    .main-progress {
      height: 100%;
      background: #4CAF50;
      width: 0%;
      transition: width 0.3s ease;
    }

    .main-counter {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 30px;
      font-weight: bold;
    }

    .zikr-container {
      margin-bottom: 100px;
    }

    .zikr-button {
      font-size: 180px;
      cursor: pointer;
      transition: transform 0.2s;
      position: relative;
      top: 0px;
    }

    .zikr-text {
      position: absolute;
      font-size: 19px;
      color: #4CAF50;
      font-weight: bold;
      text-shadow: 0 0 5px rgba(76,175,80,0.5);
      left: 50%;
      transform: translateX(-50%);
      transition: font-size 0.2s;
      width: 140%;
      max-width: 550px;
      text-align: center;
      white-space: normal;
      word-wrap: break-word;
      bottom: 270px;
      padding: 3px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 5px;
    }

    /* –°–∫—Ä—ã—Ç—ã–π —ç–ª–µ–º–µ–Ω—Ç */
    .hidden {
      display: none;
    }

    .zikr-button:active {
      transform: scale(1.1);
    }
    .zikr-button:active .zikr-text {
      font-size: 21px;
    }

    .reset-container {
      position: fixed;
      left: 20px;
      bottom: 5%;
    }

    #reset {
      border: none;
      width: 5px;
      height: 5px;
      border-radius: 50%;
      font-size: 40px;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }
    #reset:hover {
      background: #c82333;
    }

    .total-counter {
      position: fixed;
      bottom: 5%;
      right: 20px;
      background: rgba(0,0,0,0.4);
      padding: 10px 20px;
      border-radius: 10px;
      font-size: 14px;
    }

    .news-text {
      padding: 10px;
      color: #aaa;
      font-size: 15px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 5px;
      margin-top: 20px;
    }

    @media (max-width: 768px) {
      .sidebar {
        width: 80%;
        left: -80%;
      }
      .sidebar.active ~ .main-progress-container {
        margin-left: 70%;
      }
    }
  </style>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é -->
  <div class="menu-btn" onclick="toggleMenu()">‚ò∞</div>
  
  <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –º–µ–Ω—é -->
  <div class="sidebar" id="sidebar">
<div id="user-container">
    <span id="user-name"></span>
</div>
    <!-- –°–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–æ–π "–ì–ª–∞–≤–Ω–∞—è" -->
    <ul class="menu-items">
      <li><a href="https://t.me/Tasbih_ru/13" id="menu-home">üì± –ì–ª–∞–≤–Ω–∞—è</a></li>
      <li><a href="https://t.me/Tasbih_ru/42" id="menu-reward">üéÅ –ù–∞–≥—Ä–∞–¥—ã</a></li>
      <li><a href="https://t.me/Tasbih_ru/44" id="menu-help">üÜò –ü–æ–º–æ—â—å</a></li>
    </ul>
<!-- –†—è–¥ –∫–Ω–æ–ø–æ–∫: —Å–±—Ä–æ—Å, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞, —Å–º–µ–Ω–∞ —è–∑—ã–∫–∞ –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π –∑–∏–∫—Ä --> 
        <div class="menu-buttons-row">
      <button id="reset-btn" onclick="resetTotalCount()">üîÑ</button>
      <button id="custom-zikr-btn" onclick="customZikr()">‚úèÔ∏è</button>
      <button id="toggle-text-btn" onclick="toggleZikrText()">üëÅÔ∏è‚Äçüó®Ô∏è</button>
      <button id="lang-toggle-btn" onclick="toggleLanguage()">RU</button>
    </div> 
    <!-- –ë–ª–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div class="stats-container">
      <!-- –°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π —Å—á–µ—Ç -->
      <div class="stat-item">
        <div class="stat-label" id="daily-label">üìÖ –°–µ–≥–æ–¥–Ω—è (–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Ü–µ–ª—å üéØ 900)</div>
        <div class="stat-value" id="stat-daily">0</div>
        <div class="stat-progress">
          <div class="stat-progress-bar" id="daily-progress"></div>
        </div>
      </div>
      <!-- –í—á–µ—Ä–∞—à–Ω–∏–π —Å—á–µ—Ç -->
      <div class="stat-item">
        <div class="stat-label" id="yesterday-label">üóìÔ∏è –í—á–µ—Ä–∞—à–Ω–∏–π —Å—á–µ—Ç</div>
        <div class="stat-value" id="stat-yesterday">0</div>
        <div class="stat-progress">
          <div class="stat-progress-bar" id="yesterday-progress"></div>
        </div>
      </div>
      <!-- –û–±—â–∏–π —Å—á–µ—Ç -->
      <div class="stat-item">
        <div class="stat-label" id="total-label">üìø –í—Å–µ–≥–æ (–ï–∂–µ–º–µ—Å—è—á–Ω—ã–π —Ü–µ–ª—å üéØ50K)</div>
        <div class="stat-value" id="stat-total">0</div>
        <div class="stat-progress">
          <div class="stat-progress-bar" id="total-progress"></div>
        </div>
      </div>
      <!-- –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å -->
      <div class="stat-item">
        <div class="stat-label" id="last-active-label">‚è± –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div>
        <div class="stat-value" id="stat-last-active">-</div>
      </div>
      <!-- –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥ -->
      <div class="stat-item">
        <div class="stat-label" id="first-date-label">üìÖ –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥</div>
        <div class="stat-value" id="stat-first-date">-</div>
      </div>
      <!-- –ù–æ–≤–æ—Å—Ç–∏ -->
      <div class="stat-item">
        <div class="news-text" id="news-text">–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Ö–∞–¥–∏—Å—ã –ü—Ä–æ—Ä–æ–∫–∞ (—Å.–∞.–≤.)</div>
      </div>
    </div>
  </div>

  <!-- –û—Å—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
  <a href="t.me/Tasbih_ru" class="top-link" target="_blank">‚ò™Ô∏è Tasbih Reward</a>

  <div class="level-container">
    <div class="level-bar">
      <div class="level-progress"></div>
      <div class="level-text" id="level-text">–£—Ä–æ–≤–µ–Ω—å <span id="level">1</span> –∏–∑ 5</div>
    </div>
  </div>

  <div class="main-progress-container">
    <div class="main-progress-bar">
      <div class="main-progress"></div>
      <div class="main-counter"><span id="count">0</span>/33</div>
    </div>
  </div>

  <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∏–∫—Ä–∞: –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤–µ—Å—å –±–ª–æ–∫ -->
  <div class="zikr-container" id="zikr-container">
    <div class="zikr-button">
      üìø
      <div class="zikr-text" id="zikr-text">–°—É–±—Ö–∞–Ω–∞–ª–ª–∞—Ö (–ü—Ä–µ—á–∏—Å—Ç –ê–ª–ª–∞—Ö)</div>
    </div>
  </div>

  <div class="reset-container">
    <button id="reset">‚≠ï</button>
  </div>

  <!-- –°—á–µ—Ç—á–∏–∫ –∑–∞ —Å–µ–≥–æ–¥–Ω—è -->
  <div class="total-counter">–°–µ–≥–æ–¥–Ω—è: <span id="today-count">0</span></div>

  <script>
    // –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∏–∫—Ä–æ–≤ —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏
    const SETTINGS = {
      zikrList: [
        { ru: "–°—É–±—Ö–∞–Ω–∞–ª–ª–∞—Ö (–ü—Ä–µ—á–∏—Å—Ç –ê–ª–ª–∞—Ö)", en: "Sub·∏•ƒÅnallƒÅh (Glory be to Allah)", ar: "ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé ÿßŸÑŸÑŸëŸéŸáŸê" },
        { ru: "–ê–ª—å—Ö–∞–º–¥—É–ª–∏–ª–ª—è—Ö (–•–≤–∞–ª–∞ –ê–ª–ª–∞—Ö—É)", en: "Al-·∏•amdu lillƒÅh (Praise be to Allah)", ar: "ÿßŸÑÿ≠ŸÖÿØ ŸÑŸÑŸá" },
        { ru: "–ê–ª–ª–∞—Ö—É –ê–∫–±–∞—Ä (–ê–ª–ª–∞—Ö –í–µ–ª–∏–∫)", en: "AllƒÅhu Akbar (Allah is the Greatest)", ar: "ÿßŸÑŸÑŸá ÿ£ŸÉÿ®ÿ±" },
        { ru: "–õ—è –∏–ª—è—Ö–∞ –∏–ª–ª—è-–õ–ª–∞—Ö (–ù–µ—Ç –±–æ–∂–µ—Å—Ç–≤–∞, –∫—Ä–æ–º–µ –ê–ª–ª–∞—Ö–∞)", en: "LƒÅ ilƒÅha illa-llƒÅh (There is no deity except Allah)", ar: "ŸÑÿß ÿ•ŸÑŸá ÿ•ŸÑÿß ÿßŸÑŸÑŸá" },
        { ru: "–ê—Å—Ç–∞–≥—Ñ–∏—Ä—É–ª–ª–∞—Ö (–ü—Ä–æ—à—É –ø—Ä–æ—â–µ–Ω–∏—è —É –ê–ª–ª–∞—Ö–∞)", en: "AstaghfirullƒÅh (I seek forgiveness from Allah)", ar: "ÿ£Ÿéÿ≥Ÿíÿ™Ÿéÿ∫ŸíŸÅŸêÿ±Ÿè ÿßŸÑŸÑŸëŸéŸáŸé" },
        { ru: "–°—É–±—Ö–∞–Ω–∞–ª–ª–∞—Ö–∏ –≤–∞ –±–∏—Ö–∞–º–¥–∏-—Ö–∏ (–ü—Ä–µ—á–∏—Å—Ç –ê–ª–ª–∞—Ö –∏ –ï–º—É —Ö–≤–∞–ª–∞)", en: "Sub·∏•ƒÅnallƒÅhi wa bi·∏•amdihƒ´ (Glory be to Allah and all praise is due to Him)", ar: "ÿ≥ÿ®ÿ≠ÿßŸÜ ÿßŸÑŸÑŸá Ÿàÿ®ÿ≠ŸÖÿØŸá" },
        { ru: "–°—É–±—Ö–∞–Ω–∞–ª–ª–∞—Ö–∏ –∞–ª—å-–ê–∑—ã–º (–ü—Ä–µ—á–∏—Å—Ç –ê–ª–ª–∞—Ö –í–µ–ª–∏–∫–∏–π)", en: "Sub·∏•ƒÅnallƒÅhi al-‚ÄòA·∫ìƒ´m (Glory be to Allah, the Most Great)", ar: "ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé ÿßŸÑŸÑŸëŸéŸáŸê ÿßŸÑŸíÿπŸéÿ∏ŸêŸäŸÖŸê" },
        { ru: "–õ–∞ –∏–ª–∞ha –∏–ª–ª–∞-–ª–õ–æh—É –≤–∞h–¥–∞h—É –ª–∞ —à–∞—Ä–∏–∫–∞ –ª–∞h. –õ–∞h—É–ª –º—É–ª–∫—É –≤–∞ –ª–∞h—É-–ª ha–º–¥–∞ –≤–∞ h—É–≤–∞ —ä–∞–ª–∞ –∫—É–ª–ª–∏ —à–∞–π–∏–Ω Q–∞–¥–∏—Ä",
          en: "LƒÅ ilƒÅha illa-llƒÅhu wa·∏•dahu lƒÅ sharƒ´ka lah, lahu-l-mulku wa lahu-l-·∏•amdu, wa huwa ‚ÄòalƒÅ kulli shay‚Äôin qadƒ´r (There is no deity except Allah, alone, without any partner. To Him belongs sovereignty and to Him belongs all praise, and He has power over all things)",
          ar: "ŸÑŸéÿß ÿ•ŸêŸÑŸ∞ŸáŸé ÿ•ŸêŸÑŸëŸéÿß ÿßŸÑŸÑŸëŸéŸáŸè ŸàŸéÿ≠ŸíÿØŸéŸáŸè ŸÑŸéÿß ÿ¥Ÿéÿ±ŸêŸäŸÉŸé ŸÑŸéŸáŸèÿå ŸÑŸéŸáŸè ÿßŸÑŸíŸÖŸèŸÑŸíŸÉŸè ŸàŸéŸÑŸéŸáŸè ÿßŸÑŸíÿ≠ŸéŸÖŸíÿØŸè ŸàŸéŸáŸèŸàŸé ÿπŸéŸÑŸéŸâ ŸÉŸèŸÑŸëŸê ÿ¥ŸéŸäŸíÿ°Ÿç ŸÇŸéÿØŸêŸäÿ±Ÿå " }
      ],
      levels: [
        { required: 3500, level: 1 },
        { required: 7000, level: 2 },
        { required: 14000, level: 3 },
        { required: 30000, level: 4 },
        { required: 50000, level: 5 }
      ]
    };

    const translations = {
      ru: {
        title: "–ù–∞–≥—Ä–∞–¥–∞ –¢–∞—Å–±–∏—Ö–∞",
        menuHome: "üì± –ì–ª–∞–≤–Ω–∞—è",
        menuReward: "üéÅ –ù–∞–≥—Ä–∞–¥—ã", 
        menuHelp: "üÜò –ü–æ–º–æ—â—å", 
        menuResetCount: "üîÑ",
        menuToggleTextVisible: "üëÅÔ∏è‚Äçüó®Ô∏è",
        menuToggleTextHidden: "üôà",
        menuChangeLang: "RU",
        statDaily: "üìÖ –°–µ–≥–æ–¥–Ω—è (–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Ü–µ–ª—å üéØ 900)",
        statYesterday: "üóìÔ∏è –í—á–µ—Ä–∞—à–Ω–∏–π —Å—á–µ—Ç",
        statTotal: "üìø –í—Å–µ–≥–æ (–ï–∂–µ–º–µ—Å—è—á–Ω—ã–π —Ü–µ–ª—å üéØ50K)",
        statLastActive: "‚è± –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",
        statFirstVisit: "üìÖ –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥",
        statNews: "–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Ö–∞–¥–∏—Å—ã –ü—Ä–æ—Ä–æ–∫–∞ (—Å.–∞.–≤.)",
        levelText: "–£—Ä–æ–≤–µ–Ω—å {level} –∏–∑ 5",
        dailyCounterLabel: "–°–µ–≥–æ–¥–Ω—è: ",
        alertResetSuccess: "–û–±—â–∏–π —Å—á–µ—Ç —Å–±—Ä–æ—à–µ–Ω!",
        alertResetFailure: "–î–ª—è —Å–±—Ä–æ—Å–∞ –Ω—É–∂–Ω–æ –±–æ–ª–µ–µ 100000 –∑–∏–∫—Ä–æ–≤!"
      },
      en: {
        title: "Tasbih Reward",
        menuHome: "üì± Home",
        menuReward: "üéÅ Rewards", 
        menuHelp: "üÜò Help",  
        menuResetCount: "üîÑ",
        menuToggleTextVisible: "üëÅÔ∏è Hide text",
        menuToggleTextHidden: "üôà Show text",
        menuChangeLang: "EN",
        statDaily: "üìÖ Today (Daily goal üéØ 900)",
        statYesterday: "üóìÔ∏è Yesterday's count",
        statTotal: "üìø Total (Monthly goal üéØ50K)",
        statLastActive: "‚è± Last activity",
        statFirstVisit: "üìÖ First visit",
        statNews: "Hadiths of the Prophet (PBUH) will be displayed here",
        levelText: "Level {level} of 5",
        dailyCounterLabel: "Today: ",
        alertResetSuccess: "Total count reset!",
        alertResetFailure: "Need more than 100000 zikr to reset!"
      },
      ar: {
        title: "ÿ¨ÿßÿ¶ÿ≤ÿ© ÿßŸÑÿ™ÿ≥ÿ®Ÿäÿ≠",
        menuHome: "ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©",
        menuReward: "üéÅ ÿßŸÑÿ¨Ÿàÿßÿ¶ÿ≤", 
        menuHelp: "üÜò ÿ™ÿπŸÑŸäŸÖÿßÿ™" ,  
        menuResetCount: "üîÑ",
        menuToggleTextVisible: "üëÅÔ∏è ÿ•ÿÆŸÅÿßÿ° ÿßŸÑŸÜÿµ",
        menuToggleTextHidden: "üôà ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑŸÜÿµ",
        menuChangeLang: "AR",
        statDaily: "üìÖ ÿßŸÑŸäŸàŸÖ (ÿßŸÑŸáÿØŸÅ ÿßŸÑŸäŸàŸÖŸä üéØ 900)",
        statYesterday: "üóìÔ∏è ÿπÿØÿØ ÿßŸÑÿ£ÿ∞ŸÉÿßÿ± ÿßŸÑÿ®ÿßÿ±ÿ≠ÿ©",
        statTotal: "üìø ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä (ÿßŸÑŸáÿØŸÅ ÿßŸÑÿ¥Ÿáÿ±Ÿä üéØ50K)",
        statLastActive: "‚è± ÿ¢ÿÆÿ± ŸÜÿ¥ÿßÿ∑",
        statFirstVisit: "üìÖ ÿ£ŸàŸÑ ÿØÿÆŸàŸÑ",
        statNews: "ÿ≥Ÿäÿ™ŸÖ ÿπÿ±ÿ∂ ÿ£ÿ≠ÿßÿØŸäÿ´ ÿßŸÑŸÜÿ®Ÿä (ÿµŸÑŸâ ÿßŸÑŸÑŸá ÿπŸÑŸäŸá Ÿàÿ≥ŸÑŸÖ) ŸáŸÜÿß",
        levelText: "ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ {level} ŸÖŸÜ 5",
        dailyCounterLabel: "ÿßŸÑŸäŸàŸÖ: ",
        alertResetSuccess: "ÿ™ŸÖ ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑÿπÿØÿØ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä!",
        alertResetFailure: "Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ ÿßŸÑÿπÿØÿØ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿ£ŸÉÿ´ÿ± ŸÖŸÜ 100000 ŸÑŸÑÿ™ŸÖŸÉŸÜ ŸÖŸÜ ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ÿπŸäŸäŸÜ!"
      }
    };

    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Å–æ–∑–¥–∞—ë–º –Ω–∞—á–∞–ª—å–Ω—ã–µ
    let appData = JSON.parse(localStorage.getItem('tasbihData')) || {
      count: 0,
      totalCount: 0,
      currentZikrIndex: 0,
      firstVisitDate: new Date().toISOString(),
      dailyCount: 0,
      yesterdayCount: 0,
      lastVisitDate: new Date().toLocaleDateString(),
      lastActive: null,
      isZikrTextVisible: true,
      lang: "ru",
      customZikr: "",            // –ù–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∑–∏–∫—Ä–∞
      customZikrEnabled: false   // –§–ª–∞–≥, –≤–∫–ª—é—á–µ–Ω –ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π –∑–∏–∫—Ä
    };

    const tg = window.Telegram.WebApp;

    let touchStartX = 0;
    let touchStartY = 0;
    const SWIPE_THRESHOLD = 10;
    const ACTION_INTERVAL = 300;
    let lastActionTime = 0;

    tg.ready();
    tg.onEvent('auth', setUserName);
    tg.expand();
    updateStats();
    updateDisplays();
    updateLanguage();

    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –±–æ–∫–æ–≤–æ–≥–æ –º–µ–Ω—é
    function toggleMenu() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('active');
      if (sidebar.classList.contains('active')) updateStats();
    }

function setUserName() {
    if (tg.initDataUnsafe?.user?.first_name) {
        document.getElementById('user-name').textContent = `üü¢  ${tg.initDataUnsafe.user.first_name}`;
    } else {
        document.getElementById('user-name').textContent = "üë§‚ÅâÔ∏è";
    }
}

// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–º—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ Telegram WebApp
tg.ready();
setUserName();
tg.onEvent('auth', setUserName);

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –∑–∏–∫—Ä–∞: —Å–∫—Ä—ã–≤–∞–µ–º –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç, –Ω–æ –∏ –≤–µ—Å—å –±–ª–æ–∫ —Å —ç–º–æ–¥–∑–∏ (–∫–Ω–æ–ø–∫–∞ –∫–ª–∏–∫–∞)
    function toggleZikrText() {
      appData.isZikrTextVisible = !appData.isZikrTextVisible;
      // –°–∫—Ä—ã–≤–∞–µ–º/–ø–æ–∫–∞–∑—ã–≤–∞–µ–º –±–ª–æ–∫ —Å –∑–∏–∫—Ä–æ–º —Ü–µ–ª–∏–∫–æ–º
      document.getElementById('zikr-container').classList.toggle('hidden', !appData.isZikrTextVisible);
      updateToggleTextBtn();
      toggleMenu();
      saveData();
    }

    function updateToggleTextBtn() {
      const lang = appData.lang;
      const btn = document.getElementById('toggle-text-btn');
      if (btn) {
        btn.textContent = appData.isZikrTextVisible
          ? translations[lang].menuToggleTextVisible
          : translations[lang].menuToggleTextHidden;
      }
    }

    // –°–±—Ä–æ—Å –æ–±—â–µ–≥–æ —Å—á—ë—Ç–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –ø–µ—Ä–µ–≤–µ–¥—ë–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
    function resetTotalCount() {
      const lang = appData.lang;
      if (appData.totalCount > 100000) {
        appData.totalCount = 0;
        updateDisplays();
        saveData();
        alert(translations[lang].alertResetSuccess);
      } else {
        alert(translations[lang].alertResetFailure);
      }
      toggleMenu();
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∑–∏–∫—Ä–∞
    function customZikr() {
      if (appData.customZikrEnabled) {
        // –ï—Å–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π –∑–∏–∫—Ä —É–∂–µ –≤–∫–ª—é—á—ë–Ω, —Å–ø—Ä–∞—à–∏–≤–∞–µ–º, —Ö–æ—á–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ–≥–æ –æ—Ç–∫–ª—é—á–∏—Ç—å
        if (confirm("–í—ã —Ö–æ—Ç–∏—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å —Å–≤–æ–π –∑–∏–∫—Ä –∏ –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–∏–∫—Ä—ã?")) {
          appData.customZikrEnabled = false;
          appData.customZikr = "";
          updateDisplays();
          saveData();
        }
      } else {
        // –ï—Å–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π –∑–∏–∫—Ä –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –µ–≥–æ –≤–≤–æ–¥
        let customText = prompt("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–ª–æ–≤–æ –∑–∏–∫—Ä–∞:");
        if (customText && customText.trim() !== "") {
          appData.customZikr = customText.trim();
          appData.customZikrEnabled = true;
          updateDisplays();
          saveData();
        }
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    function updateStats() {
      const dailyProgress = (appData.dailyCount / 900) * 100;
      document.getElementById('daily-progress').style.width = `${Math.min(dailyProgress, 100)}%`;
      document.getElementById('stat-daily').textContent = appData.dailyCount;

      document.getElementById('stat-yesterday').textContent = appData.yesterdayCount;
      document.getElementById('yesterday-progress').style.width = `${Math.min((appData.yesterdayCount / 900) * 100, 100)}%`;

      document.getElementById('stat-total').textContent = appData.totalCount;
      document.getElementById('total-progress').style.width = `${Math.min((appData.totalCount / 50000) * 100, 100)}%`;

      document.getElementById('stat-first-date').textContent =
        new Date(appData.firstVisitDate).toLocaleDateString(appData.lang, {
          day: 'numeric',
          month: 'long',
          year: 'numeric'
        });

      document.getElementById('stat-last-active').textContent =
        new Date().toLocaleDateString(appData.lang, {
          day: 'numeric',
          month: 'long',
          year: 'numeric',
          hour: '2-digit',
          minute: '2-digit'
        });
    }

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    function saveData() {
      appData.lastActive = new Date().toISOString();
      localStorage.setItem('tasbihData', JSON.stringify(appData));
      updateStats();
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤ –∏ –∑–∏–∫—Ä–∞ —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º
    function updateDisplays() {
      const today = new Date().toLocaleDateString();
      if (appData.lastVisitDate !== today) {
        appData.yesterdayCount = appData.dailyCount;
        appData.dailyCount = 0;
        appData.lastVisitDate = today;
      }

      document.getElementById('count').textContent = appData.count;
      document.getElementById('today-count').textContent = appData.dailyCount;
      // –ï—Å–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π –∑–∏–∫—Ä –≤–∫–ª—é—á—ë–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ, –∏–Ω–∞—á–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∑–∏–∫—Ä
      if (appData.customZikrEnabled && appData.customZikr) {
        document.getElementById('zikr-text').textContent = appData.customZikr;
      } else {
        document.getElementById('zikr-text').textContent =
          SETTINGS.zikrList[appData.currentZikrIndex][appData.lang];
      }

      document.querySelector('.main-progress').style.width = `${(appData.count / 33) * 100}%`;

      const levelProgress = calculateLevelProgress();
      document.querySelector('.level-progress').style.width = `${levelProgress}%`;
    }

    // –†–∞—Å—á—ë—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —É—Ä–æ–≤–Ω—è
    function calculateLevelProgress() {
      const currentLevel = SETTINGS.levels.find(l => appData.totalCount < l.required) || { level: 5 };
      document.getElementById('level').textContent = currentLevel.level;
      const prevLevel = SETTINGS.levels[currentLevel.level - 2] || { required: 0 };
      return ((appData.totalCount - prevLevel.required) / (currentLevel.required - prevLevel.required)) * 100 || 100;
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ (—É—á—ë—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏)
    function handleClick() {
      const now = Date.now();
      if (now - lastActionTime < ACTION_INTERVAL) return;
      lastActionTime = now;

      if (document.getElementById('sidebar').classList.contains('active')) {
        toggleMenu();
      }

      appData.count++;
      appData.totalCount++;
      appData.dailyCount++;

      if (appData.count === 33) {
        appData.count = 0;
        appData.currentZikrIndex = (appData.currentZikrIndex + 1) % SETTINGS.zikrList.length;
      }

      updateDisplays();
      updateStats();
      saveData();
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–≤–∞–π–ø–æ–≤
    function handleSwipe(e) {
      const touchEndX = e.changedTouches[0].clientX;
      const touchEndY = e.changedTouches[0].clientY;
      const deltaX = touchEndX - touchStartX;
      const deltaY = touchEndY - touchStartY;
      if (Math.abs(deltaX) > SWIPE_THRESHOLD || Math.abs(deltaY) > SWIPE_THRESHOLD) {
        handleClick();
      }
    }

    function handleTouchStart(e) {
      touchStartX = e.touches[0].clientX;
      touchStartY = e.touches[0].clientY;
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Å–±—Ä–æ—Å–∞ (—Å—Ç–∞—Ä—ã–π, –æ—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞)
    document.getElementById('reset').addEventListener('click', () => {
      if (appData.totalCount > 100) {
        appData.totalCount--;
      }
      appData.count = 0;
      appData.currentZikrIndex = 0;
      updateDisplays();
      saveData();
    });

    // –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –∏ —Å–≤–∞–π–ø–æ–≤
    document.addEventListener('click', (e) => {
      if (!e.target.closest('#reset') && !e.target.closest('.menu-btn')) {
        handleClick();
      }
    });
    document.addEventListener('touchstart', handleTouchStart);
    document.addEventListener('touchend', handleSwipe);

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞
    function toggleLanguage() {
      const langs = ["ru", "en", "ar"];
      let currentIndex = langs.indexOf(appData.lang);
      currentIndex = (currentIndex + 1) % langs.length;
      appData.lang = langs[currentIndex];
      saveData();
      updateLanguage();
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–µ–∫—Å—Ç–æ–≤ —Å–æ–≥–ª–∞—Å–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —è–∑—ã–∫—É
    function updateLanguage() {
      const lang = appData.lang;
      document.title = translations[lang].title;
      document.getElementById('menu-home').textContent = translations[lang].menuHome;
      document.getElementById('menu-reward').textContent = translations[lang].menuReward;
      document.getElementById('menu-help').textContent = translations[lang].menuHelp;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —Ä—è–¥–∞
      document.getElementById('reset-btn').textContent = translations[lang].menuResetCount;
      updateToggleTextBtn();
      document.getElementById('lang-toggle-btn').textContent = translations[lang].menuChangeLang;
      
      document.getElementById('daily-label').textContent = translations[lang].statDaily;
      document.getElementById('yesterday-label').textContent = translations[lang].statYesterday;
      document.getElementById('total-label').textContent = translations[lang].statTotal;
      document.getElementById('last-active-label').textContent = translations[lang].statLastActive;
      document.getElementById('first-date-label').textContent = translations[lang].statFirstVisit;
      document.getElementById('news-text').textContent = translations[lang].statNews;
      
      const totalCounter = document.querySelector('.total-counter');
      totalCounter.innerHTML = translations[lang].dailyCounterLabel + '<span id="today-count">' + appData.dailyCount + '</span>';
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —É—Ä–æ–≤–Ω—è
      const levelElem = document.getElementById('level').textContent;
      document.getElementById('level-text').innerHTML = translations[lang].levelText.replace("{level}", '<span id="level">' + levelElem + '</span>');
    }

    function init() {
      const today = new Date().toLocaleDateString();
      if (appData.lastVisitDate !== today) {
        appData.yesterdayCount = appData.dailyCount;
        appData.dailyCount = 0;
        appData.lastVisitDate = today;
        saveData();
      }
    }

    init();
  </script>
</body>
</html>